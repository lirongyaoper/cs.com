# Tree ç±»å®Œæ•´æ•™ç¨‹ - æ·±å…¥ç†è§£ get_tree() æ–¹æ³•

## ç›®å½•
1. [Tree ç±»åŸºç¡€æ¦‚å¿µ](#1-tree-ç±»åŸºç¡€æ¦‚å¿µ)
2. [æ•°æ®ç»“æ„å‡†å¤‡](#2-æ•°æ®ç»“æ„å‡†å¤‡)
3. [Tree ç±»çš„ä¸»è¦æ–¹æ³•](#3-tree-ç±»çš„ä¸»è¦æ–¹æ³•)
4. [get_tree() æ–¹æ³•æ·±åº¦è§£æ](#4-get_tree-æ–¹æ³•æ·±åº¦è§£æ)
5. [get_tree() æ‰§è¡Œæµç¨‹å›¾è§£](#5-get_tree-æ‰§è¡Œæµç¨‹å›¾è§£)
6. [å‚æ•°è¯¦è§£ä¸å®ä¾‹](#6-å‚æ•°è¯¦è§£ä¸å®ä¾‹)
7. [å¸¸è§åº”ç”¨åœºæ™¯](#7-å¸¸è§åº”ç”¨åœºæ™¯)
8. [å¸¸è§é—®é¢˜è§£ç­”](#8-å¸¸è§é—®é¢˜è§£ç­”)

---

## 1. Tree ç±»åŸºç¡€æ¦‚å¿µ

### 1.1 ä»€ä¹ˆæ˜¯æ ‘å½¢ç»“æ„ï¼Ÿ

æ ‘å½¢ç»“æ„æ˜¯ä¸€ç§ç‰¹æ®Šçš„æ•°æ®ç»„ç»‡æ–¹å¼ï¼Œå…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š

```
é¡¶çº§åˆ†ç±»ï¼ˆparentid=0ï¼‰
â”œâ”€â”€ å­åˆ†ç±»1ï¼ˆparentidæŒ‡å‘é¡¶çº§ï¼‰
â”‚   â”œâ”€â”€ å­åˆ†ç±»1-1ï¼ˆparentidæŒ‡å‘å­åˆ†ç±»1ï¼‰
â”‚   â””â”€â”€ å­åˆ†ç±»1-2ï¼ˆparentidæŒ‡å‘å­åˆ†ç±»1ï¼‰
â””â”€â”€ å­åˆ†ç±»2ï¼ˆparentidæŒ‡å‘é¡¶çº§ï¼‰
    â””â”€â”€ å­åˆ†ç±»2-1ï¼ˆparentidæŒ‡å‘å­åˆ†ç±»2ï¼‰
```

**å…³é”®æ¦‚å¿µï¼š**
- **èŠ‚ç‚¹ï¼ˆNodeï¼‰**: æ ‘ä¸­çš„æ¯ä¸ªå…ƒç´ 
- **æ ¹èŠ‚ç‚¹ï¼ˆRootï¼‰**: æœ€é¡¶å±‚çš„èŠ‚ç‚¹ï¼Œparentid é€šå¸¸ä¸º 0
- **çˆ¶èŠ‚ç‚¹ï¼ˆParentï¼‰**: æŸä¸ªèŠ‚ç‚¹çš„ä¸Šä¸€å±‚èŠ‚ç‚¹
- **å­èŠ‚ç‚¹ï¼ˆChildï¼‰**: æŸä¸ªèŠ‚ç‚¹çš„ä¸‹ä¸€å±‚èŠ‚ç‚¹
- **å¶å­èŠ‚ç‚¹ï¼ˆLeafï¼‰**: æ²¡æœ‰å­èŠ‚ç‚¹çš„èŠ‚ç‚¹

### 1.2 Tree ç±»èƒ½åšä»€ä¹ˆï¼Ÿ

Tree ç±»å°†æ‰å¹³çš„æ•°ç»„æ•°æ®è½¬æ¢ä¸ºæ ‘å½¢ç»“æ„å±•ç¤ºï¼š

**è¾“å…¥ï¼ˆæ‰å¹³æ•°ç»„ï¼‰ï¼š**
```php
[
    1 => ['id'=>1, 'parentid'=>0, 'name'=>'ç”µå­äº§å“'],
    2 => ['id'=>2, 'parentid'=>0, 'name'=>'æœè£…'],
    3 => ['id'=>3, 'parentid'=>1, 'name'=>'æ‰‹æœº'],
    4 => ['id'=>4, 'parentid'=>1, 'name'=>'ç”µè„‘'],
]
```

**è¾“å‡ºï¼ˆæ ‘å½¢HTMLï¼‰ï¼š**
```
ç”µå­äº§å“
â”œâ”€ æ‰‹æœº
â””â”€ ç”µè„‘
æœè£…
```

---

## 2. æ•°æ®ç»“æ„å‡†å¤‡

### 2.1 æ ‡å‡†æ•°æ®æ ¼å¼

Tree ç±»è¦æ±‚è¾“å…¥çš„æ•°ç»„å¿…é¡»å…·å¤‡ä»¥ä¸‹å­—æ®µï¼š

```php
$data = [
    é”®å => [
        'id'       => èŠ‚ç‚¹çš„å”¯ä¸€æ ‡è¯†,
        'parentid' => çˆ¶èŠ‚ç‚¹çš„IDï¼ˆé¡¶çº§èŠ‚ç‚¹ä¸º0ï¼‰,
        'name'     => èŠ‚ç‚¹æ˜¾ç¤ºåç§°,
        // ... å…¶ä»–è‡ªå®šä¹‰å­—æ®µ
    ]
];
```

### 2.2 ç¤ºä¾‹æ•°æ®

```php
$categories = [
    1 => ['id'=>1, 'parentid'=>0, 'name'=>'ç”µå­äº§å“', 'url'=>'/electronics'],
    2 => ['id'=>2, 'parentid'=>0, 'name'=>'å›¾ä¹¦', 'url'=>'/books'],
    3 => ['id'=>3, 'parentid'=>1, 'name'=>'æ‰‹æœº', 'url'=>'/phone'],
    4 => ['id'=>4, 'parentid'=>1, 'name'=>'ç”µè„‘', 'url'=>'/computer'],
    5 => ['id'=>5, 'parentid'=>3, 'name'=>'è‹¹æœæ‰‹æœº', 'url'=>'/iphone'],
    6 => ['id'=>6, 'parentid'=>3, 'name'=>'å®‰å“æ‰‹æœº', 'url'=>'/android'],
    7 => ['id'=>7, 'parentid'=>2, 'name'=>'å°è¯´', 'url'=>'/novel'],
];
```

è¿™ä¸ªæ•°æ®è¡¨ç¤ºçš„æ ‘å½¢ç»“æ„ï¼š
```
ç”µå­äº§å“ (id=1)
â”œâ”€â”€ æ‰‹æœº (id=3)
â”‚   â”œâ”€â”€ è‹¹æœæ‰‹æœº (id=5)
â”‚   â””â”€â”€ å®‰å“æ‰‹æœº (id=6)
â””â”€â”€ ç”µè„‘ (id=4)
å›¾ä¹¦ (id=2)
â””â”€â”€ å°è¯´ (id=7)
```

---

## 3. Tree ç±»çš„ä¸»è¦æ–¹æ³•

### 3.1 æ–¹æ³•æ¦‚è§ˆ

| æ–¹æ³•å | åŠŸèƒ½ | å¸¸ç”¨ç¨‹åº¦ |
|--------|------|----------|
| `init()` | åˆå§‹åŒ–æ•°æ® | â­â­â­â­â­ |
| `get_child()` | è·å–å­èŠ‚ç‚¹ | â­â­â­â­â­ |
| `get_tree()` | ç”Ÿæˆæ ‘å½¢ç»“æ„ | â­â­â­â­â­ |
| `get_parent()` | è·å–çˆ¶çº§çš„å…„å¼ŸèŠ‚ç‚¹ | â­â­â­ |
| `get_pos()` | è·å–å½“å‰ä½ç½®çš„é¢åŒ…å±‘ | â­â­â­â­ |

### 3.2 åŸºæœ¬ä½¿ç”¨æµç¨‹

```php
// 1. å®ä¾‹åŒ–
$tree = new tree();

// 2. åˆå§‹åŒ–æ•°æ®
$tree->init($categories);

// 3. è°ƒç”¨æ–¹æ³•ç”Ÿæˆæ ‘å½¢ç»“æ„
$html = $tree->get_tree(0, $template);
```

---

## 4. get_tree() æ–¹æ³•æ·±åº¦è§£æ

### 4.1 æ–¹æ³•ç­¾å

```php
public function get_tree($myid, $str, $sid = 0, $adds = '', $str_group = '')
```

### 4.2 å‚æ•°è¯¦è§£

#### å‚æ•°1: `$myid` (æ•´æ•°)
- **ä½œç”¨**: æŒ‡å®šä»å“ªä¸ªèŠ‚ç‚¹å¼€å§‹ç”Ÿæˆæ ‘
- **å¸¸ç”¨å€¼**: 
  - `0` - ä»æ ¹èŠ‚ç‚¹å¼€å§‹ï¼Œç”Ÿæˆæ•´æ£µæ ‘
  - `å…·ä½“ID` - ä»æŒ‡å®šèŠ‚ç‚¹å¼€å§‹ï¼Œåªç”Ÿæˆè¯¥èŠ‚ç‚¹çš„å­æ ‘

**ç¤ºä¾‹ï¼š**
```php
// ç”Ÿæˆæ•´æ£µæ ‘
$tree->get_tree(0, $str);

// åªç”Ÿæˆ id=1 èŠ‚ç‚¹ä¸‹çš„å­æ ‘
$tree->get_tree(1, $str);
```

#### å‚æ•°2: `$str` (å­—ç¬¦ä¸²) - **æ ¸å¿ƒå‚æ•°**
- **ä½œç”¨**: HTMLæ¨¡æ¿å­—ç¬¦ä¸²ï¼Œå®šä¹‰æ¯ä¸ªèŠ‚ç‚¹çš„è¾“å‡ºæ ¼å¼
- **å¯ç”¨å˜é‡**: æ•°ç»„ä¸­çš„æ‰€æœ‰å­—æ®µéƒ½å¯ä»¥ä½¿ç”¨ï¼ˆé€šè¿‡ `extract()` æå–ï¼‰
- **ç‰¹æ®Šå˜é‡**:
  - `$id` - èŠ‚ç‚¹ID
  - `$parentid` - çˆ¶èŠ‚ç‚¹ID
  - `$name` - èŠ‚ç‚¹åç§°
  - `$spacer` - ç¼©è¿›ç¬¦å·ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰
  - `$selected` - é€‰ä¸­çŠ¶æ€ï¼ˆ'selected' æˆ– ''ï¼‰

**ç¤ºä¾‹ï¼š**
```php
// ç®€å•æ–‡æœ¬
$str = "\$spacer\$name\n";

// HTML option æ ‡ç­¾
$str = "<option value='\$id' \$selected>\$spacer\$name</option>";

// HTML åˆ—è¡¨
$str = "<li data-id='\$id'>\$spacer\$name</li>";

// å¤æ‚ HTML
$str = "<div class='item'><a href='\$url'>\$spacer\$name</a></div>";
```

#### å‚æ•°3: `$sid` (æ•´æ•°æˆ–æ•°ç»„) - å¯é€‰
- **ä½œç”¨**: æŒ‡å®šå“ªäº›èŠ‚ç‚¹åº”è¯¥è¢«æ ‡è®°ä¸ºé€‰ä¸­çŠ¶æ€
- **ç”¨é€”**: åœ¨ç¼–è¾‘è¡¨å•ä¸­é¢„é€‰æŸä¸ªåˆ†ç±»

**ç¤ºä¾‹ï¼š**
```php
// å•ä¸ªé€‰ä¸­
$tree->get_tree(0, $str, 3);  // id=3 çš„èŠ‚ç‚¹ä¼šè¢«æ ‡è®°ä¸º selected

// å¤šä¸ªé€‰ä¸­
$tree->get_tree(0, $str, [3, 5, 7]);  // å¤šä¸ªèŠ‚ç‚¹è¢«æ ‡è®°
```

#### å‚æ•°4: `$adds` (å­—ç¬¦ä¸²) - å†…éƒ¨ä½¿ç”¨
- **ä½œç”¨**: é€’å½’æ—¶ç´¯ç§¯çš„ç¼©è¿›å‰ç¼€
- **æ³¨æ„**: ç¬¬ä¸€æ¬¡è°ƒç”¨æ—¶åº”è¯¥ä¸ºç©ºå­—ç¬¦ä¸² ''
- **åŸç†**: æ¯æ·±å…¥ä¸€å±‚ï¼Œå°±ä¼šæ·»åŠ ä¸€ä¸ªç¼©è¿›ç¬¦å·

#### å‚æ•°5: `$str_group` (å­—ç¬¦ä¸²) - å¯é€‰
- **ä½œç”¨**: ä¸ºé¡¶çº§åˆ†ç±»ï¼ˆparentid=0ï¼‰æä¾›ä¸åŒçš„æ¨¡æ¿
- **ç”¨é€”**: é¡¶çº§å’Œå­çº§ä½¿ç”¨ä¸åŒçš„æ ·å¼

**ç¤ºä¾‹ï¼š**
```php
$str = "<option value='\$id'>&nbsp;&nbsp;\$spacer\$name</option>";
$str_group = "<option value='\$id' style='font-weight:bold'>\$name</option>";
$tree->get_tree(0, $str, 0, '', $str_group);
```

### 4.3 è¿”å›å€¼

- **ç±»å‹**: å­—ç¬¦ä¸²
- **å†…å®¹**: æŒ‰æ ‘å½¢ç»“æ„ç»„ç»‡çš„ HTML ä»£ç 

---

## 5. get_tree() æ‰§è¡Œæµç¨‹å›¾è§£

### 5.1 æ•´ä½“æµç¨‹å›¾

```
å¼€å§‹ get_tree($myid=0)
    â”‚
    â”œâ”€â†’ è°ƒç”¨ get_child($myid) è·å–å­èŠ‚ç‚¹
    â”‚       â”‚
    â”‚       â””â”€â†’ è¿”å›æ‰€æœ‰ parentid=$myid çš„èŠ‚ç‚¹
    â”‚
    â”œâ”€â†’ éå†æ¯ä¸ªå­èŠ‚ç‚¹
    â”‚       â”‚
    â”‚       â”œâ”€â†’ åˆ¤æ–­æ˜¯å¦ä¸ºæœ€åä¸€ä¸ªèŠ‚ç‚¹
    â”‚       â”‚       â”œâ”€ æ˜¯ â†’ ä½¿ç”¨ â”” ç¬¦å·
    â”‚       â”‚       â””â”€ å¦ â†’ ä½¿ç”¨ â”œ ç¬¦å·
    â”‚       â”‚
    â”‚       â”œâ”€â†’ æ„å»ºç¼©è¿›ç¬¦å· $spacer
    â”‚       â”‚
    â”‚       â”œâ”€â†’ åˆ¤æ–­æ˜¯å¦é€‰ä¸­
    â”‚       â”‚
    â”‚       â”œâ”€â†’ ä½¿ç”¨ extract() æå–æ•°ç»„å­—æ®µ
    â”‚       â”‚
    â”‚       â”œâ”€â†’ ä½¿ç”¨ eval() æ‰§è¡Œæ¨¡æ¿å­—ç¬¦ä¸²
    â”‚       â”‚
    â”‚       â”œâ”€â†’ å°†ç»“æœè¿½åŠ åˆ° $this->ret
    â”‚       â”‚
    â”‚       â””â”€â†’ é€’å½’è°ƒç”¨ get_tree(å­èŠ‚ç‚¹ID)  â† å…³é”®ï¼
    â”‚
    â””â”€â†’ è¿”å› $this->ret
```

### 5.2 é€’å½’è¿‡ç¨‹è¯¦è§£

å‡è®¾æœ‰ä»¥ä¸‹æ•°æ®ï¼š
```php
1 => ['id'=>1, 'parentid'=>0, 'name'=>'A'],
2 => ['id'=>2, 'parentid'=>1, 'name'=>'B'],
3 => ['id'=>3, 'parentid'=>1, 'name'=>'C'],
4 => ['id'=>4, 'parentid'=>2, 'name'=>'D'],
```

æ ‘å½¢ç»“æ„ï¼š
```
A (1)
â”œâ”€â”€ B (2)
â”‚   â””â”€â”€ D (4)
â””â”€â”€ C (3)
```

**æ‰§è¡Œæ­¥éª¤ï¼š**

```
ç¬¬1æ¬¡è°ƒç”¨: get_tree(0)
    è·å–å­èŠ‚ç‚¹: [1]
    å¤„ç†èŠ‚ç‚¹1 (A)
        spacer = ''
        è¾“å‡º: "A"
        
        ç¬¬2æ¬¡è°ƒç”¨: get_tree(1, adds='â”‚ ')
            è·å–å­èŠ‚ç‚¹: [2, 3]
            å¤„ç†èŠ‚ç‚¹2 (B) - ä¸æ˜¯æœ€åä¸€ä¸ª
                spacer = 'â”œ'
                è¾“å‡º: "â”œB"
                
                ç¬¬3æ¬¡è°ƒç”¨: get_tree(2, adds='â”‚ â”‚ ')
                    è·å–å­èŠ‚ç‚¹: [4]
                    å¤„ç†èŠ‚ç‚¹4 (D) - æ˜¯æœ€åä¸€ä¸ª
                        spacer = 'â”‚ â”‚ â””'
                        è¾“å‡º: "â”‚ â”‚ â””D"
                        
                        ç¬¬4æ¬¡è°ƒç”¨: get_tree(4)
                            è·å–å­èŠ‚ç‚¹: [] (ç©º)
                            è¿”å›
            
            å¤„ç†èŠ‚ç‚¹3 (C) - æ˜¯æœ€åä¸€ä¸ª
                spacer = 'â”‚ â””'
                è¾“å‡º: "â”‚ â””C"
                
                ç¬¬5æ¬¡è°ƒç”¨: get_tree(3)
                    è·å–å­èŠ‚ç‚¹: [] (ç©º)
                    è¿”å›
```

### 5.3 ç¼©è¿›ç¬¦å·çš„æ„å»ºé€»è¾‘

```php
// å½“å‰æ˜¯å¦ä¸ºæœ€åä¸€ä¸ªèŠ‚ç‚¹ï¼Ÿ
if($number == $total) {
    $j = 'â””';  // æ˜¯ â†’ ä½¿ç”¨ â””
} else {
    $j = 'â”œ';  // å¦ â†’ ä½¿ç”¨ â”œ
    $k = $adds ? 'â”‚' : '';  // å¦‚æœæœ‰å‰ç¼€ï¼Œæ·»åŠ ç«–çº¿
}

// æ„å»ºå®Œæ•´çš„ç¼©è¿›
$spacer = $adds ? $adds.$j : '';
```

**ç¤ºä¾‹ï¼š**

```
å±‚çº§1: $adds='',      $j='â”œ'  â†’  $spacer = 'â”œ'
å±‚çº§2: $adds='â”‚ ',    $j='â””'  â†’  $spacer = 'â”‚ â””'
å±‚çº§3: $adds='â”‚ â”‚ ', $j='â”œ'  â†’  $spacer = 'â”‚ â”‚ â”œ'
```

### 5.4 å…³é”®ä»£ç é€è¡Œè§£æ

```php
public function get_tree($myid, $str, $sid = 0, $adds = '', $str_group = '') {
    $number = 1;  // è®¡æ•°å™¨ï¼Œç”¨äºåˆ¤æ–­æ˜¯å¦ä¸ºæœ€åä¸€ä¸ªèŠ‚ç‚¹
    
    // â‘  è·å–å½“å‰èŠ‚ç‚¹çš„æ‰€æœ‰å­èŠ‚ç‚¹
    $child = $this->get_child($myid);
    
    // â‘¡ å¦‚æœæœ‰å­èŠ‚ç‚¹
    if(is_array($child)) {
        $total = count($child);  // å­èŠ‚ç‚¹æ€»æ•°
        
        // â‘¢ éå†æ¯ä¸ªå­èŠ‚ç‚¹
        foreach($child as $id => $value) {
            $j = $k = '';
            
            // â‘£ åˆ¤æ–­æ˜¯å¦ä¸ºæœ€åä¸€ä¸ªèŠ‚ç‚¹ï¼Œå†³å®šä½¿ç”¨ä»€ä¹ˆç¬¦å·
            if($number == $total) {
                $j .= $this->icon[2];  // â””
            } else {
                $j .= $this->icon[1];  // â”œ
                $k = $adds ? $this->icon[0] : '';  // â”‚
            }
            
            // â‘¤ æ„å»ºç¼©è¿›ç¬¦å·
            $spacer = $adds ? $adds.$j : '';
            
            // â‘¥ å¤„ç†é€‰ä¸­çŠ¶æ€
            $selected = '';
            if(is_array($sid)) {
                $selected = in_array($id, $sid) ? 'selected' : '';
            } else {
                $selected = $id == $sid ? 'selected' : '';
            }
            
            // â‘¦ æå–æ•°ç»„å­—æ®µä¸ºå˜é‡
            // ä¾‹å¦‚: ['id'=>3, 'name'=>'æ‰‹æœº'] 
            // ä¼šç”Ÿæˆ: $id=3, $name='æ‰‹æœº'
            @extract($value);
            
            // â‘§ æ ¹æ®æ˜¯å¦ä¸ºé¡¶çº§åˆ†ç±»é€‰æ‹©æ¨¡æ¿
            $parentid == 0 && $str_group 
                ? eval("\$nstr = \"$str_group\";") 
                : eval("\$nstr = \"$str\";");
            
            // â‘¨ è¿½åŠ åˆ°ç»“æœå­—ç¬¦ä¸²
            $this->ret .= $nstr;
            
            // â‘© é€’å½’è°ƒç”¨ï¼Œå¤„ç†å­èŠ‚ç‚¹çš„å­èŠ‚ç‚¹
            $nbsp = $this->nbsp;
            $this->get_tree($id, $str, $sid, $adds.$k.$nbsp, $str_group);
            
            $number++;  // è®¡æ•°å™¨åŠ 1
        }
    }
    
    return $this->ret;  // è¿”å›æœ€ç»ˆç»“æœ
}
```

---

## 6. å‚æ•°è¯¦è§£ä¸å®ä¾‹

### 6.1 æ¨¡æ¿å­—ç¬¦ä¸² `$str` çš„ä½¿ç”¨

#### å®ä¾‹1: ç”Ÿæˆä¸‹æ‹‰åˆ—è¡¨

```php
$str = "<option value='\$id' \$selected>\$spacer\$name</option>";
$html = $tree->get_tree(0, $str);
```

**è¾“å‡ºï¼š**
```html
<option value='1'>ç”µå­äº§å“</option>
<option value='3'>â”œæ‰‹æœº</option>
<option value='5'>â”‚&nbsp;â”œè‹¹æœæ‰‹æœº</option>
<option value='6'>â”‚&nbsp;â””å®‰å“æ‰‹æœº</option>
<option value='4'>â””ç”µè„‘</option>
```

#### å®ä¾‹2: ç”Ÿæˆæ— åºåˆ—è¡¨

```php
$str = "<li data-id='\$id' class='\$selected'>\$spacer\$name</li>";
$html = $tree->get_tree(0, $str);
```

#### å®ä¾‹3: ç”Ÿæˆé“¾æ¥èœå•

```php
$str = "<div><a href='\$url'>\$spacer\$name</a></div>";
$html = $tree->get_tree(0, $str);
```

#### å®ä¾‹4: ä½¿ç”¨è‡ªå®šä¹‰å­—æ®µ

å‡è®¾æ•°æ®ä¸­æœ‰ `icon` å’Œ `count` å­—æ®µï¼š
```php
$data = [
    1 => ['id'=>1, 'parentid'=>0, 'name'=>'åˆ†ç±»A', 'icon'=>'ğŸ“', 'count'=>10],
];

$str = "<div>\$spacer\$icon \$name (\$count)</div>";
```

**è¾“å‡ºï¼š**
```
ğŸ“ åˆ†ç±»A (10)
```

### 6.2 é€‰ä¸­çŠ¶æ€ `$sid` çš„ä½¿ç”¨

#### åœºæ™¯: ç¼–è¾‘æ–‡ç« æ—¶é€‰æ‹©åˆ†ç±»

```php
// å½“å‰æ–‡ç« å±äº id=5 çš„åˆ†ç±»
$current_category = 5;

$str = "<option value='\$id' \$selected>\$spacer\$name</option>";
$html = $tree->get_tree(0, $str, $current_category);
```

**ç»“æœï¼š** id=5 çš„ option ä¼šæœ‰ `selected` å±æ€§

### 6.3 åˆ†ç»„æ¨¡æ¿ `$str_group` çš„ä½¿ç”¨

```php
// æ™®é€šå­åˆ†ç±»
$str = "<option value='\$id' \$selected>&nbsp;&nbsp;\$spacer\$name</option>";

// é¡¶çº§åˆ†ç±»ï¼ˆåŠ ç²—æ˜¾ç¤ºï¼‰
$str_group = "<option value='\$id' \$selected style='font-weight:bold'>\$name</option>";

$html = $tree->get_tree(0, $str, 0, '', $str_group);
```

**è¾“å‡ºï¼š**
```html
<option value='1' style='font-weight:bold'>ç”µå­äº§å“</option>
<option value='3' selected>&nbsp;&nbsp;â”œæ‰‹æœº</option>
<option value='5'>&nbsp;&nbsp;â”‚&nbsp;â”œè‹¹æœæ‰‹æœº</option>
```

---

## 7. å¸¸è§åº”ç”¨åœºæ™¯

### 7.1 åœºæ™¯1: ç½‘ç«™åˆ†ç±»å¯¼èˆª

```php
$tree = new tree();
$tree->init($categories);

// ç”Ÿæˆä¸‹æ‹‰é€‰æ‹©æ¡†
$str = "<option value='\$id' \$selected>\$spacer\$name</option>";
$html = '<select name="category">' . $tree->get_tree(0, $str) . '</select>';
```

### 7.2 åœºæ™¯2: åå°èœå•

```php
$str = "<li><a href='\$url' data-id='\$id'>\$spacer\$name</a></li>";
$menu = '<ul class="menu">' . $tree->get_tree(0, $str) . '</ul>';
```

### 7.3 åœºæ™¯3: æƒé™ç®¡ç†

```php
// $user_permissions æ˜¯ç”¨æˆ·å·²æœ‰çš„æƒé™IDæ•°ç»„
$str = "<label><input type='checkbox' name='perms[]' value='\$id' \$selected> \$spacer\$name</label><br>";
$html = $tree->get_tree(0, $str, $user_permissions);
```

### 7.4 åœºæ™¯4: åªæ˜¾ç¤ºæŸä¸ªåˆ†ç±»çš„å­æ ‘

```php
// åªæ˜¾ç¤º id=1 ä¸‹çš„æ‰€æœ‰å­åˆ†ç±»
$html = $tree->get_tree(1, $str);
```

---

## 8. å¸¸è§é—®é¢˜è§£ç­”

### Q1: ä¸ºä»€ä¹ˆæˆ‘çš„æ ‘å½¢ç»“æ„æ˜¾ç¤ºä¸æ­£ç¡®ï¼Ÿ

**A:** æ£€æŸ¥ä»¥ä¸‹å‡ ç‚¹ï¼š
1. æ•°æ®æ•°ç»„çš„é”®åå¿…é¡»æ˜¯èŠ‚ç‚¹çš„ ID
2. ç¡®ä¿æ¯ä¸ªèŠ‚ç‚¹éƒ½æœ‰ `id` å’Œ `parentid` å­—æ®µ
3. `parentid` å¿…é¡»æŒ‡å‘å­˜åœ¨çš„èŠ‚ç‚¹ï¼ˆæˆ–ä¸º 0ï¼‰
4. ä¸èƒ½æœ‰å¾ªç¯å¼•ç”¨ï¼ˆAçš„çˆ¶æ˜¯Bï¼ŒBçš„çˆ¶æ˜¯Aï¼‰

### Q2: å¦‚ä½•è‡ªå®šä¹‰ç¼©è¿›ç¬¦å·ï¼Ÿ

**A:** ä¿®æ”¹ `$tree->icon` å±æ€§ï¼š
```php
$tree = new tree();
$tree->icon = ['|', '+--', '`--'];  // è‡ªå®šä¹‰ç¬¦å·
$tree->nbsp = '&nbsp;&nbsp;';        // è‡ªå®šä¹‰ç©ºæ ¼
```

### Q3: eval() æ˜¯å¦æœ‰å®‰å…¨é£é™©ï¼Ÿ

**A:** 
- åœ¨æ­¤åœºæ™¯ä¸‹ï¼Œ`$str` æ˜¯å¼€å‘è€…è‡ªå·±å®šä¹‰çš„ï¼Œä¸æ˜¯ç”¨æˆ·è¾“å…¥ï¼Œæ‰€ä»¥ç›¸å¯¹å®‰å…¨
- å¦‚æœ `$str` æ¥è‡ªç”¨æˆ·è¾“å…¥ï¼Œç¡®å®æœ‰é£é™©ï¼Œéœ€è¦ä¸¥æ ¼è¿‡æ»¤

### Q4: å¦‚ä½•ç”Ÿæˆ JSON æ ¼å¼è€Œä¸æ˜¯ HTMLï¼Ÿ

**A:** ä¸å»ºè®®ç”¨ `get_tree()` ç”Ÿæˆ JSONï¼Œè€Œåº”è¯¥ï¼š
```php
// ä½¿ç”¨é€’å½’å‡½æ•°è‡ªå·±æ„å»ºæ•°ç»„
function buildTreeArray($tree, $myid) {
    $result = [];
    $children = $tree->get_child($myid);
    if ($children) {
        foreach ($children as $id => $item) {
            $item['children'] = buildTreeArray($tree, $id);
            $result[] = $item;
        }
    }
    return $result;
}

$treeArray = buildTreeArray($tree, 0);
$json = json_encode($treeArray);
```

### Q5: å¦‚ä½•å¤„ç†å¤§é‡æ•°æ®çš„æ€§èƒ½é—®é¢˜ï¼Ÿ

**A:** 
1. ä½¿ç”¨ç¼“å­˜å­˜å‚¨ç”Ÿæˆçš„ HTML
2. è€ƒè™‘å»¶è¿ŸåŠ è½½ï¼ˆåªåŠ è½½é¡¶çº§ï¼Œç‚¹å‡»æ—¶ AJAX åŠ è½½å­çº§ï¼‰
3. å¯¹äºè¶…å¤§æ ‘ï¼ˆ1000+èŠ‚ç‚¹ï¼‰ï¼Œè€ƒè™‘ä½¿ç”¨ä¸“é—¨çš„æ ‘å½¢ç»„ä»¶åº“

### Q6: å¦‚ä½•æ·»åŠ èŠ‚ç‚¹å±æ€§ï¼ˆå¦‚ CSS classï¼‰ï¼Ÿ

**A:** åœ¨æ•°æ®ä¸­æ·»åŠ å­—æ®µï¼Œç„¶ååœ¨æ¨¡æ¿ä¸­ä½¿ç”¨ï¼š
```php
$data = [
    1 => ['id'=>1, 'parentid'=>0, 'name'=>'åˆ†ç±»A', 'css_class'=>'important'],
];

$str = "<div class='\$css_class'>\$spacer\$name</div>";
```

---

## æ€»ç»“

### get_tree() æ–¹æ³•çš„æ ¸å¿ƒæ€æƒ³

1. **é€’å½’éå†**: ä»æŒ‡å®šèŠ‚ç‚¹å¼€å§‹ï¼Œé€’å½’è®¿é—®æ‰€æœ‰å­èŠ‚ç‚¹
2. **åŠ¨æ€ç¼©è¿›**: æ ¹æ®å±‚çº§è‡ªåŠ¨ç”Ÿæˆç¼©è¿›ç¬¦å·
3. **çµæ´»æ¨¡æ¿**: é€šè¿‡æ¨¡æ¿å­—ç¬¦ä¸²è‡ªå®šä¹‰è¾“å‡ºæ ¼å¼
4. **çŠ¶æ€ç®¡ç†**: æ”¯æŒé€‰ä¸­çŠ¶æ€çš„æ ‡è®°

### å­¦ä¹ å»ºè®®

1. **ç†è§£é€’å½’**: get_tree() çš„æ ¸å¿ƒæ˜¯é€’å½’ï¼ŒåŠ¡å¿…ç†è§£é€’å½’çš„åŸç†
2. **è°ƒè¯•è¾“å‡º**: åœ¨å­¦ä¹ æ—¶ï¼Œå¯ä»¥åœ¨æ–¹æ³•ä¸­æ·»åŠ  `echo` è¯­å¥è§‚å¯Ÿæ‰§è¡Œæµç¨‹
3. **åŠ¨æ‰‹å®è·µ**: ä¿®æ”¹ç¤ºä¾‹ä»£ç ï¼Œå°è¯•ä¸åŒçš„æ¨¡æ¿å’Œæ•°æ®
4. **é˜…è¯»æºç **: åå¤é˜…è¯» tree.class.php çš„æºç ï¼Œç†è§£æ¯ä¸€è¡Œ

### è¿›é˜¶æ–¹å‘

1. å­¦ä¹ å…¶ä»–æ–¹æ³•ï¼š`get_pos()`, `get_parent()`, `get_child()`
2. ç ”ç©¶ `get_tree_multi()` å’Œ `get_tree_category()` çš„åŒºåˆ«
3. å°è¯•ä¿®æ”¹æºç ï¼Œæ·»åŠ æ–°åŠŸèƒ½
4. ç»“åˆå‰ç«¯æ¡†æ¶ï¼ˆVueã€Reactï¼‰å®ç°åŠ¨æ€æ ‘

---

**ä¸‹ä¸€æ­¥**: è¿è¡Œ `examples/` ç›®å½•ä¸‹çš„ç¤ºä¾‹ä»£ç ï¼Œè§‚å¯Ÿå®é™…æ•ˆæœï¼

